var shiftHeld=!1,body,loader,dialog_max_width=964,comfirm_dialog;$(document).ready(function(){body=$("body"),init_navigation(),body.on("ajax:beforeSend","a[data-remote], form[data-remote]",function(){attachLoading("body")}).on("ajax:complete",function(){removeLoading("body")}).on("click","a.remove_fields",function(){return $(this).prev("input[type=hidden]").val("1"),$(this).closest(".fields").hide(),!1}).on("change",".observe_field",function(){target=$(this).attr("data-update"),ajax_indicator=$(this).attr("data-ajax-indicator")||"#busy_indicator",$(target).hide(),$(ajax_indicator).show(),$.ajax({dataType:"html",url:$(this).attr("data-base-url")+encodeURIComponent($(this).val()),type:"get",success:function(e){$(target).html(e),$(ajax_indicator).hide(),$(target).show()}})}),add_fields=function(e,t,r){var a=(new Date).getTime(),i=new RegExp("new_"+t,"g");$(e).append(r.replace(i,a)),$("input.color-field").each(function(){$(this).css("backgroundColor",$(this).attr("value")).colorpicker().on("changeColor",function(e){$(this).css("backgroundColor",e.color.toHex())})})},$.rails.allowAction=function(e){var t=e.data("confirm"),r=!1;return t?($.rails.fire(e,"confirm")&&bootbox.confirm({message:t,callback:function(t){if(t){$.rails.fire(e,"confirm:complete",[r]);var a=$.rails.allowAction;$.rails.allowAction=function(){return!0},e.trigger("click"),$.rails.allowAction=a}},buttons:{cancel:{label:"Non annuler"},confirm:{label:"Oui supprimer",className:"btn-danger"}}}),!1):!0},$('a[rel="tooltip"], a[rel="tooltip nofollow"]').tooltip(),$('input[rel="popover"]').popover(),$(".btn.toggle").on("click",function(e){e.preventDefault(),$($(this).attr("href")).toggle()}),init_text_editor(),init_images(),$("textarea.wysihtml5").wysihtml5({stylesheets:"/assets/gko_wysihtml5_body.css"}),$("input.color-field").each(function(){$(this).css("backgroundColor",$(this).attr("value")).colorpicker().on("changeColor",function(e){$(this).css("backgroundColor",e.color.toHex())})}),$(".panel-toogle").on("click",function(e){e.preventDefault(),$($(this).attr("data-target")).toggleClass("open")}),$(".ui-draggable").draggable(),$(window).trigger("resize")});